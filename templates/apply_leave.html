{% extends "base.html" %}

{% block title %}Apply Leave - HRMS{% endblock %}

{% block content %}
<div class="card-custom" style="max-width: 700px; margin: 0 auto;">
    <div class="card-header-custom">
        <h3 class="mb-0">
            <i class="fas fa-plus-circle"></i> Apply for Leave
        </h3>
    </div>
    <div class="card-body" style="padding: 2rem;">
        <form method="POST" action="{{ url_for('apply_leave') }}">
            <div class="mb-3">
                <label class="form-label-custom">Leave Type</label>
                <select name="leave_type" class="form-control form-control-custom" required>
                    <option value="">Select leave type</option>
                    <option value="Paid">Paid Leave</option>
                    <option value="Sick">Sick Leave</option>
                    <option value="Unpaid">Unpaid Leave</option>
                    <option value="Casual">Casual Leave</option>
                </select>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label class="form-label-custom">Start Date</label>
                    <input type="date" name="start_date" class="form-control form-control-custom" min="{{ today }}"
                        required>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label-custom">End Date</label>
                    <input type="date" name="end_date" class="form-control form-control-custom" min="{{ today }}"
                        required>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label-custom">Reason</label>
                <textarea name="reason" class="form-control form-control-custom" rows="4"
                    placeholder="Please provide a reason for your leave request" required></textarea>
            </div>

            <div class="alert"
                style="background: rgba(99, 102, 241, 0.1); border: 1px solid var(--primary-color); border-radius: 10px; padding: 1rem;">
                <i class="fas fa-info-circle" style="color: var(--primary-color);"></i>
                <small style="color: var(--text-light);">
                    Your leave request will be sent to HR for approval. You will be notified once it's reviewed.
                </small>
            </div>

            <div class="d-flex gap-2 mt-4">
                <button type="submit" class="btn btn-primary-custom">
                    <i class="fas fa-paper-plane"></i> Submit Request
                </button>
                <a href="{{ url_for('leave') }}" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Cancel
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Set today's date as minimum
    const today = new Date().toISOString().split('T')[0];
    document.querySelectorAll('input[type="date"]').forEach(input => {
        input.setAttribute('min', today);
    });

    // Validate end date is after start date
    const startDate = document.querySelector('input[name="start_date"]');
    const endDate = document.querySelector('input[name="end_date"]');

    startDate.addEventListener('change', function () {
        endDate.setAttribute('min', this.value);
        if (endDate.value && endDate.value < this.value) {
            endDate.value = this.value;
        }
    });
</script>
{% endblock %}